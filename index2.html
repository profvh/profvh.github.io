<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta lang="pt_br">
        <title>Professor Victor Hugo Lázaro Lopes</title>
        <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
        
        <link rel="stylesheet" href="css/style.css"><link rel="stylesheet" href="css/principal.css">

        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    </head>
    <body>
        
        <!-- abre o menu principal -->
        <nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top menu">
            <a class="navbar-brand" href="#">
                <div class="logo">pvh();</div>
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                  <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                </li>
                
              </ul>
              <form class="form-inline my-2 my-lg-0">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
              </form>
            </div>
          </nav>
        <!-- //fecha o menu principal -->        
        
        
        <!-- abre o corpo do site -section1 -->
        <section class="container corpo">
            <div>
            	<div id="body-header">
	                <h1>Bem-vindo ao meu site</h1>
	                <p>Sou o professor Victor Hugo Lopes. Atuo nas disciplinas que envolvem a engenharia de software, em nível técnico e superior. Estou na docência desde 2011, mas já atua com computação desde 2003.</p>
	            </div>    
                <div class="row">
                	
                	<div class="col-12 col-md-12 col-xl-12 col-sm-12">
                		<h5 id="destaque-header">Destaque</h5>
                		<div id="mostraPost" class="post">
                			
                		</div>
                	</div>

                	<div class="col-12 col-md-8 col-xl-8 col-sm-6">
                		<h5>Últimos Posts</h5>
                		<div id="mostraUltimosPosts" class="falsolink"></div>
                	</div>

                	<div class="col-12 col-md-4 col-xl-4 col-sm-6">
                		<h5>Categorias</h5>
                		<div id="mostraCategorias" class="falsolink"></div>
                	</div>
                	
                </div>
                
                
            </div>    
        </section>
        <!-- //fecha o corpo do site -section1 -->
        
        <!-- rodapé -->
        <footer class="container">
            <li><a href="/">Professor Victor Hugo Lopes</a></li>
            <li>2K19 - Quase todos os direitos reservados</li>
            <li>Feito por Índio Véio</li>
        </footer>
        <!-- //rodapé -->
        
    </body>
    <script src="js/jquery.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript">
    	$(document).ready(function() {
           carregaDados();
       	});
       	function carregaDados(){
       		carregaCategorias();
       		carregaUltimosPosts();
       	}
       	var posts;
       	function carregaPrincipal(){
       		count = posts.length;
       		c = Math.floor((Math.random() * count-1) + 1);
       		while(posts[c].post_status!="publish" && posts[c].post_type!="post"){
       			c--;
       			if(c<0) c = count-1;
       		}
       		abrePost(posts[c]);          		
           	
       	}
       	function carregaCategorias(){
       		$.ajax({
               	url:"data/wp_terms.json"
           		}).done(function(data){
           			//alert(data.length);
           			$.each(data,function(indice,valor){
           				item = "<li onClick='abreCategoria(\""+valor.term_id+"\")'>"+valor.name+"</li>";
           				$("#mostraCategorias").append(item);
           			});
               	}).fail(function(request, error){
               		alert("falhou "+error);
            });	               
           
       	}
       	function carregaUltimosPosts(){
       		$.ajax({
               	url:"data/wp_posts.json"
           		}).done(function(data){
           			posts = data;
           			count = data.length;
           			i=1;
           			while(i<=5){
           				if(data[count-1].post_status=="publish" && data[count-1].post_type=="post"){
           					item = "<li onClick='abrePostClicado(\""+data[count-1].ID+"\")'>"+data[count-1].post_title+"</li>";
           					$("#mostraUltimosPosts").append(item);
           					i++;
           				}
           				count--;
           			}
           			carregaPrincipal();
               	}).fail(function(request, error){
               		alert("falhou --"+error);
            });	
       	}
       	function abrePostClicado(id){
       		p = null;
       		for(i=0;i<posts.length;i++){
       			if(posts[i].ID == id){
       				p =posts[i];
       				break;
       			}
       		}
       		if(p!=null){
       			preparaTela();
       			abrePost(p);
       			document.title = "Professor Victor Hugo Lopes - " + p.post_title;
       		}	
       	}
       	function preparaTela(){
       		$("#body-header").remove();
       		$("#mostraPost").empty();
       		$("#destaque-header").remove();
       	}
       	function abrePost(p){
       		item = "<h2 class='post-title entry-title'>"+p.post_title+"</h2>";
           	$("#mostraPost").append(item);
           	meta = "<div class='entry-meta'><ul class='post-meta'><li><span class='posted-on'><time class='entry-date published updated' datetime='"+p.post_date+"'>"+p.post_date+"</time></span></li></ul></div>";
           	$("#mostraPost").append(meta);
           	corpo = "<div class='container post-body'>"+p.post_content+"</div>";
           	$("#mostraPost").append(corpo);
       	}
    </script>
</html>
