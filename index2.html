<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta lang="pt_br">
        <title>Professor Victor Hugo Lázaro Lopes</title>
        <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

        
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="css/principal.css">
        <link rel="stylesheet" href="css/social-icons.css">

        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        
        

    </head>
    <body>
        
        <!-- abre o menu principal -->
        <nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top menu">
            <a class="navbar-brand" href="#">
                <div class="logo">pvh();</div>
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                  <a class="nav-link" href="index2.html">Home <span class="sr-only">(current)</span></a>
                </li>
                
              </ul>
              <form method="GET" action="index2.html" class="form-inline my-2 my-lg-0">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" name="search" required="required" aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
              </form>
            </div>
          </nav>
        <!-- //fecha o menu principal -->        
        
        
        <!-- abre o corpo do site -section1 -->
        <section class="container corpo">
            <div>
            	<div id="body-header">
	                <h1>Bem-vindo ao meu site</h1>
	                <p>Sou o professor Victor Hugo Lopes. Atuo nas disciplinas que envolvem a engenharia de software, em nível técnico e superior. Estou na docência desde 2011, mas já atua com computação desde 2003, já tendo atuado no desenvolvimento de dezenas de sistemas para desktop, sistemas web e aplicativos.</p>
	            </div>    
                <div class="row">
                	
                	<div class="col-12 col-md-12 col-xl-12 col-sm-12">
                		<h5 id="destaque-header">Destaque</h5>
                		<div id="mostraPost" class="post">
                			
                		</div>
                	</div>

                	<div class="col-12 col-md-8 col-xl-8 col-sm-6">
                		<h5>Últimos Posts</h5>
                		<div id="mostraUltimosPosts" class="falsolink"></div>
                		<div class="icones-p">
                			<h5>Siga-me em minhas redes sociais!!</h5>
                			<center>
                				<a href="https://www.facebook.com/victorhullopes" target="_blank" class="fa fa-facebook"></a>
								<a href="https://twitter.com/hullopes" target="_blank" class="fa fa-twitter"></a>
								<a href="https://plus.google.com/u/0/+victorhugolopesprof" target="_blank" class="fa fa-google"></a>
								<a href="https://www.linkedin.com/in/victorhugolopes/" target="_blank" class="fa fa-linkedin"></a>
								<a href="https://www.youtube.com/channel/UC6cwfjE2vdD1fk3jaF_f07A" target="_blank" class="fa fa-youtube"></a>
                			</center>
                		</div>
                	</div>

                	<div class="col-12 col-md-4 col-xl-4 col-sm-6">
                		<h5>Categorias</h5>
                		<div id="mostraCategorias" class="falsolink"></div>
                	</div>
                	
                </div>
                
                
            </div>    
        </section>
        <!-- //fecha o corpo do site -section1 -->
        
        <!-- rodapé -->
        <footer class="container">
            <li><a href="/">Professor Victor Hugo Lopes</a></li>
            <li>2K19 - Quase todos os direitos reservados</li>
            <li>Feito por Índio Véio</li>
        </footer>
        <!-- //rodapé -->
        
    </body>
    <script src="js/jquery.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript">
    	var category;
    	var posts = null;
    	var terms = null;
    	var term_rel = null;
    	var tax = [];
    	var busca;
    	$(document).ready(function() {
           carregaDados();           	
       	});
       	function buscaForm(){
       		if(getUrlParameter("search")!=null){
	       		this.busca = getUrlParameter("search").toLowerCase();
	       		this.busca = this.busca.replace("+"," ");
	       		cont=0;
	       		ps = [];
	       		if(this.busca != null){
	       			for(i=0;i<this.posts.length;i++){
	       				p = this.posts[i];
	       				titulo = p.post_title.toLowerCase();
		       			if(titulo.includes(this.busca) && p.post_status=="publish" && p.post_type=="post"){
		       				ps[cont] =this.posts[i];
		       				cont++;
		       			}
		       		}
	       		}
	       		if(this.busca!=null || this.busca != "")
			       		abreMultiplosPosts(ps,"busca");
			}       	
       	}
       	function buscaPeloNome(){
       		post = null;
       		selectedPost = getUrlParameter("p");
           	if(selectedPost != null){
           		for(i=0;i<this.posts.length;i++){
	       			if(this.posts[i].post_name == selectedPost){
	       				post =this.posts[i];
	       				break;
	       			}
	       		}
           	}
           	if(post != null)
           		abrePostClicado(post.ID);
       	}
       	function buscaPelaCategoria(){
       		this.category = getUrlParameter("categoria");
           	
       		t = null; 
       		this.tax = [];
       			//encontrando o termo de interesse para obter seu ID
	       		for(i=0;i<terms.length;i++){
	       			if(terms[i].slug == this.category){
	       				t =terms[i];
	       				break;
	       			}
	       		}
	       		//encontrando os id dos termos relacionados
	       		//esses ids são os ids dos posts
	       		if(t!=null){
	       			count = 0;
	       			for(i=0;i<term_rel.length;i++){
	       				if(term_rel[i].term_taxonomy_id==t.term_id){
	       					tax[count] = term_rel[i];
	       					count++;
	       				}
	       			}
	       		}
	       		getPosts();			
       	}
       	function getPosts(){
       		//procurando os posts pelos IDs
	       		var ps = []; //array de posts
	       		cont=0;
	       		c=100;
	       		if(this.posts ==null && c>0){
	       			c--;
	       		}
	       		if(this.posts == null){
	       			carregaTodosPosts('bycat');
	       		}
		       		
       	}
       	function getUrlParameter(sParam) {
			    var sPageURL = window.location.search.substring(1),
			        sURLVariables = sPageURL.split('&'),
			        sParameterName,
			        i;

			    for (i = 0; i < sURLVariables.length; i++) {
			        sParameterName = sURLVariables[i].split('=');

			        if (sParameterName[0] === sParam) {
			            return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
			        }
			    }
			    return null;
			};
       	function carregaDados(){
       		carregaCategorias();
       		carregaUltimosPosts();
       	}
       	
       	function carregaPrincipal(){
       		count = posts.length;
       		c = Math.floor((Math.random() * count-1) + 1);
       		while(posts[c].post_status!="publish" && posts[c].post_type!="post"){
       			c--;
       			if(c<0) c = count-1;
       		}
       		abrePost(posts[c]);          		
           	
       	}
       	function carregaCatRel(){
       		$.ajax({
               	url:"data/wp_term_relationships.json"
           		}).done(function(data){
           			window.term_rel = data; 
           			buscaPelaCategoria();      			
               	}).fail(function(request, error){
               		alert("falhou ao buscar wp_term_relationships "+error);
            });	               
           
       	}
       	function carregaCategorias(){
       		$.ajax({
               	url:"data/wp_terms.json"
           		}).done(function(data){           			
           			window.terms = data;
           			$.each(data,function(indice,valor){
           				item = "<li><a href='?categoria="+valor.slug+"'>"+valor.name+"</a></li>";
           				$("#mostraCategorias").append(item);
           			});
           			carregaCatRel();
               	}).fail(function(request, error){
               		alert("falhou "+error);
            });	               
           
       	}
       	function abrePostsBuscados(){
       		cont=0;
       		ps = [];
       		for(i=0;i<this.tax.length;i++){
       					t=this.tax[i].object_id;
		       			for(ii=0;ii<this.posts.length;ii++){
	       					if(this.posts[ii].ID == t && this.posts[ii].post_type=='post' && this.posts[ii].post_status=='publish'){
	       						ps[cont]=this.posts[ii];
	       						cont++;
	       					}
	       				}	
		       		}
		       	if(ps.length>0)
		       		abreMultiplosPosts(ps,"categoria");
       	}
       	function abreMultiplosPosts(ps,tp){
       		preparaTela();
       		title="Professor Victor Hugo Lopes - Listando posts de ";
       		if(tp=="categoria"){
       			title += this.category;
       			item = "<h2 class='post-title entry-title'>Listando posts de "+this.category+"</h2>";
       		}else if(tp=="busca"){
       			title += this.busca;
       			item = "<h2 class='post-title entry-title'>Listando posts da busca por ´´"+this.busca+"´´</h2>";
       		}
       		item += (ps.length==0) ? "<h5>Nenhum post encontrado!</h5>" : "";	

       		document.title=title;
       		
           	$("#mostraPost").append(item);
           	var corpo = "<div class='container post-body'>";
           	for(i=0;i<ps.length;i++){

           		corpo += "<li><a href='?p="+ps[i].post_name+"'>"+ps[i].post_title+"</a></li>";
           	}
           	corpo += "</div>";
           	$("#mostraPost").append(corpo);
       	}
       	function carregaTodosPosts(tp){
       		$.ajax({
               	url:"data/wp_posts.json"
           		}).done(function(data){
           			window.posts = data;   
           			if(tp=='bycat')        			
           				abrePostsBuscados();
               	}).fail(function(request, error){
               		alert("falhou o carregamento dos posts--"+error);
            });	
       	}
       	function carregaUltimosPosts(){
       		$.ajax({
               	url:"data/wp_posts.json"
           		}).done(function(data){
           			posts = data;
           			window.posts = data;
           			count = data.length;
           			i=1;
           			while(i<=5){
           				if(data[count-1].post_status=="publish" && data[count-1].post_type=="post"){
           					item = "<li><a href='?p="+data[count-1].post_name+"'>"+data[count-1].post_title+"</a></li>";
           					$("#mostraUltimosPosts").append(item);
           					i++;
           				}
           				count--;
           			}
           			carregaPrincipal();
           			buscaPeloNome();
           			buscaForm();
               	}).fail(function(request, error){
               		alert("falhou --"+error);
            });	
       	}
       	function abrePostClicado(id){
       		p = null;
       		for(i=0;i<posts.length;i++){
       			if(posts[i].ID == id){
       				p =posts[i];
       				break;
       			}
       		}
       		if(p!=null){
       			preparaTela();
       			abrePost(p);
       			document.title = "Professor Victor Hugo Lopes - " + p.post_title;
       		}	
       	}
       	function preparaTela(){
       		$("#body-header").remove();
       		$("#mostraPost").empty();
       		$("#destaque-header").remove();
       	}
       	function abrePost(p){
       		item = "<h2 class='post-title entry-title'>"+p.post_title+"</h2>";
           	$("#mostraPost").append(item);
           	meta = "<div class='entry-meta'><ul class='post-meta'><li><span class='posted-on'><time class='entry-date published updated' datetime='"+p.post_date+"'>"+p.post_date+"</time></span></li></ul></div>";
           	$("#mostraPost").append(meta);
           	corpo = "<div class='container post-body'>"+p.post_content+"</div>";
           	$("#mostraPost").append(corpo);
       	}
    </script>
</html>
